<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>运行 kubeadm init 之前 - 小楼一夜听春雨</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="龙哥" />
  <meta name="description" content="在运行 kubeadm init 之前的动作 kubelet 服务检查 后来发现，在这里应该测试一下 kubelet.service。 原来，虽然我 apt install kubelet , 但是， 遗留了之前 kubeadm 的一些配置." />

  <meta name="keywords" content="小楼一夜听春雨, devops, trader, cloud-native" />






<meta name="generator" content="Hugo 0.46" />


<link rel="canonical" href="https://b.qqbb.app/post/kubeadm-init-before-v1_8_3/" />



<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.aaf3394fc81ccb6f6fe3fe458d1f5b61c39f151e44df83baaf1d7b3775a8b98d.css" integrity="sha256-qvM5T8gcy29v4/5FjR9bYcOfFR5E34O6rx17N3WouY0=" media="screen">





<meta property="og:title" content="运行 kubeadm init 之前" />
<meta property="og:description" content="在运行 kubeadm init 之前的动作 kubelet 服务检查 后来发现，在这里应该测试一下 kubelet.service。 原来，虽然我 apt install kubelet , 但是， 遗留了之前 kubeadm 的一些配置." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://b.qqbb.app/post/kubeadm-init-before-v1_8_3/" />



<meta property="article:published_time" content="2018-11-23T00:00:00&#43;08:00"/>

<meta property="article:modified_time" content="2018-11-23T16:55:11&#43;08:00"/>











<meta itemprop="name" content="运行 kubeadm init 之前">
<meta itemprop="description" content="在运行 kubeadm init 之前的动作 kubelet 服务检查 后来发现，在这里应该测试一下 kubelet.service。 原来，虽然我 apt install kubelet , 但是， 遗留了之前 kubeadm 的一些配置.">


<meta itemprop="datePublished" content="2018-11-23T00:00:00&#43;08:00" />
<meta itemprop="dateModified" content="2018-11-23T00:00:00&#43;08:00" />
<meta itemprop="wordCount" content="1888">



<meta itemprop="keywords" content="kubernetes,install,before," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="运行 kubeadm init 之前"/>
<meta name="twitter:description" content="在运行 kubeadm init 之前的动作 kubelet 服务检查 后来发现，在这里应该测试一下 kubelet.service。 原来，虽然我 apt install kubelet , 但是， 遗留了之前 kubeadm 的一些配置."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">小楼一夜听春雨</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/">首页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/about/">关于</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/post/works/">作品</a>
          
        
      </li>
    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      小楼一夜听春雨
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/">首页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/about/">关于</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://b.qqbb.app/post/works/">作品</a>
          

        

      </li>
    
    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">运行 kubeadm init 之前</h1>
      
      <div class="post-meta">
        <time datetime="2018-11-23" class="post-time">
          2018-11-23
        </time>
        <div class="post-category">
            <a href="https://b.qqbb.app/categories/kubernetes/"> kubernetes </a>
            
          </div>
        <span class="more-meta"> 约 1888 字 </span>
          <span class="more-meta"> 预计阅读 4 分钟 </span>

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#kubelet-服务检查">kubelet 服务检查</a>
<ul>
<li><a href="#删除这个新安装的-kubelet">删除这个新安装的 kubelet</a></li>
<li><a href="#删除原-conf-文件">删除原 conf 文件</a></li>
<li><a href="#再安装-kubelet">再安装 kubelet</a></li>
<li><a href="#kubelet-stop">kubelet stop</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<p>在运行 kubeadm init 之前的动作</p>

<h2 id="kubelet-服务检查">kubelet 服务检查</h2>

<p>后来发现，在这里应该测试一下 kubelet.service。</p>

<p>原来，虽然我 apt install kubelet , 但是， 遗留了之前 kubeadm
的一些配置.(应该把它们清空的.) 如:
/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</p>

<p>让我们来吧。</p>

<h3 id="删除这个新安装的-kubelet">删除这个新安装的 kubelet</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">root@km:/etc/cni/net.d#
root@km:/etc/cni/net.d# apt remove kubelet
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following packages were automatically installed and are no longer required:
ebtables golang-1.8-go golang-1.8-race-detector-runtime golang-1.8-src kubernetes-cni socat
Use <span class="s1">&#39;apt autoremove&#39;</span> to remove them.
The following packages will be REMOVED:
kubeadm kubelet
<span class="m">0</span> upgraded, <span class="m">0</span> newly installed, <span class="m">2</span> to remove and <span class="m">11</span> not upgraded.
After this operation, <span class="m">274</span> MB disk space will be freed.
Do you want to <span class="k">continue</span>? <span class="o">[</span>Y/n<span class="o">]</span> y
<span class="o">(</span>Reading database ... <span class="m">113087</span> files and directories currently installed.<span class="o">)</span>
Removing kubeadm <span class="o">(</span><span class="m">1</span>.8.3-00<span class="o">)</span> ...
Removing kubelet <span class="o">(</span><span class="m">1</span>.8.3-00<span class="o">)</span> ...
root@km:/etc/cni/net.d#
root@km: ~# <span class="nb">cd</span> /lib/systemd/system
root@km:/lib/systemd/system# ls kube*
ls: cannot access <span class="s1">&#39;kube*&#39;</span>: No such file or directory
root@km:/lib/systemd/system#</code></pre></td></tr></table>
</div>
</div>
<h3 id="删除原-conf-文件">删除原 conf 文件</h3>

<p>删除从 /lib/systemd/system/kubelet.service 下看到的这个 conf 文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">root@km:/opt/cni/bin# <span class="nb">cd</span> /etc/systemd/system/kubelet.service.d/
root@km:/etc/systemd/system/kubelet.service.d# ls
<span class="m">10</span>-kubeadm.conf
root@km:/etc/systemd/system/kubelet.service.d# rm <span class="m">10</span>-kubeadm.conf
root@km:/etc/systemd/system/kubelet.service.d# <span class="nb">cd</span> ..
root@km:/etc/systemd/system# rmdir kubelet.service.d/
root@km:/etc/systemd/system#</code></pre></td></tr></table>
</div>
</div>
<h3 id="再安装-kubelet">再安装 kubelet</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">root@km:/lib/systemd/system# apt install kubelet
Reading package lists... Done
Setting up kubelet <span class="o">(</span><span class="m">1</span>.8.3-00<span class="o">)</span> ...
root@km:/lib/systemd/system# systemctl start kubelet
root@km:/lib/systemd/system# systemctl status kubelet
● kubelet.service - kubelet: The Kubernetes Node Agent
Loaded: loaded <span class="o">(</span>/lib/systemd/system/kubelet.service<span class="p">;</span> enabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
Active: activating <span class="o">(</span>auto-restart<span class="o">)</span> <span class="o">(</span>Result: exit-code<span class="o">)</span> since Fri <span class="m">2017</span>-11-17 <span class="m">17</span>:34:35 CST<span class="p">;</span> 1s ago
Docs: http://kubernetes.io/docs/
Process: <span class="m">25074</span> <span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/kubelet <span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span><span class="m">1</span>/FAILURE<span class="o">)</span>
Main PID: <span class="m">25074</span> <span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span><span class="m">1</span>/FAILURE<span class="o">)</span>

Nov <span class="m">17</span> <span class="m">17</span>:34:35 km systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>: kubelet.service: Unit entered failed state.
Nov <span class="m">17</span> <span class="m">17</span>:34:35 km systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>: kubelet.service: Failed with result <span class="s1">&#39;exit-code&#39;</span>.
root@km:/lib/systemd/system#</code></pre></td></tr></table>
</div>
</div>
<p>还出错了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">root@km:/lib/systemd/system# cat kubelet.service
<span class="o">[</span>Unit<span class="o">]</span>
<span class="nv">Description</span><span class="o">=</span>kubelet: The Kubernetes Node Agent
<span class="nv">Documentation</span><span class="o">=</span>http://kubernetes.io/docs/

<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/kubelet
<span class="nv">Restart</span><span class="o">=</span>always
<span class="nv">StartLimitInterval</span><span class="o">=</span><span class="m">0</span>
<span class="nv">RestartSec</span><span class="o">=</span><span class="m">10</span>

<span class="o">[</span>Install<span class="o">]</span>
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
root@km:/lib/systemd/system# journalctl -xe
.....
Nov <span class="m">17</span> <span class="m">17</span>:36:51 km kubelet<span class="o">[</span><span class="m">25463</span><span class="o">]</span>: error: failed to run Kubelet: Running with swap on is not supported, please disable swap! or <span class="nb">set</span> --fail-swap-on flag to false. /proc/swaps contained: <span class="o">[</span>Filename</code></pre></td></tr></table>
</div>
</div>
<p>从信息中看到，要把 swap 关闭，或者带 &ndash;fail-swap-on 参数。
那就带参数试一下先。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">root@km:/lib/systemd/system# kubelet --fail-swap-on<span class="o">=</span>false</code></pre></td></tr></table>
</div>
</div>
<p>成功逃过这个错误。 但是报了另一个错误。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">root@km:/lib/systemd/system# kubelet --fail-swap-on<span class="o">=</span><span class="nb">false</span>
W1117 <span class="m">17</span>:48:12.355020   <span class="m">27348</span> cni.go:196<span class="o">]</span> Unable to update cni config: No networks found in /etc/cni/net.d
                                          I1117 <span class="m">17</span>:48:12.361647   <span class="m">27348</span> docker_service.go:207<span class="o">]</span> Docker cri networking managed by kubernetes.io/no-op
                                                                                               error: failed to run Kubelet: failed to create kubelet: misconfiguration: kubelet cgroup driver: <span class="s2">&#34;cgroupfs&#34;</span> is different from docker cgroup driver: <span class="s2">&#34;systemd&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>这个显然与 docker 相关。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">root@km:/lib/systemd/system# cat /etc/docker/daemon.json
<span class="o">{</span>
    <span class="s2">&#34;exec-opts&#34;</span>: <span class="o">[</span><span class="s2">&#34;native.cgroupdriver=systemd&#34;</span><span class="o">]</span>,
    <span class="s2">&#34;registry-mirrors&#34;</span>: <span class="o">[</span><span class="s2">&#34;https://0d6wdn2y.mirror.aliyuncs.com&#34;</span><span class="o">]</span>
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<p>那好了，先把这个后来加进来的 &ldquo;exec-opts&rdquo;:
[&ldquo;native.cgroupdriver=systemd&rdquo;], 删除了吧。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">root@km:/lib/systemd/system# cat /etc/docker/daemon.json
<span class="o">{</span>
    <span class="s2">&#34;registry-mirrors&#34;</span>: <span class="o">[</span><span class="s2">&#34;https://0d6wdn2y.mirror.aliyuncs.com&#34;</span><span class="o">]</span>
<span class="o">}</span>
root@km:/lib/systemd/system# sudo systemctl restart docker
...
root@km:/lib/systemd/system# kubelet --fail-swap-on<span class="o">=</span><span class="nb">false</span>
I1117 <span class="m">17</span>:52:52.954982   <span class="m">28490</span> feature_gate.go:156<span class="o">]</span> feature gates: map<span class="o">[]</span>
                                                   I1117 <span class="m">17</span>:52:52.955098   <span class="m">28490</span> controller.go:114<span class="o">]</span> kubelet config controller: starting controller
                                                                                                    I1117 <span class="m">17</span>:52:52.955117   <span class="m">28490</span> controller.go:118<span class="o">]</span> kubelet config controller: validating combination of defaults and flags
                                                                                                                                                     I1117 <span class="m">17</span>:52:52.974917   <span class="m">28490</span> client.go:75<span class="o">]</span> Connecting to docker on unix:///var/run/docker.sock
                                                                                                                                                                                                 I1117 <span class="m">17</span>:52:52.974977   <span class="m">28490</span> client.go:95<span class="o">]</span> Start docker client with request <span class="nv">timeout</span><span class="o">=</span>2m0s
                                                                                                                                                                                                                                             W1117 <span class="m">17</span>:52:52.977139   <span class="m">28490</span> cni.go:196<span class="o">]</span> Unable to update cni config: No networks found in /etc/cni/net.d
                                                                                                                                                                                                                                                                                       I1117 <span class="m">17</span>:52:52.983192   <span class="m">28490</span> feature_gate.go:156<span class="o">]</span> feature gates: map<span class="o">[]</span>
                                                                                                                                                                                                                                                                                                                                          W1117 <span class="m">17</span>:52:52.983420   <span class="m">28490</span> server.go:289<span class="o">]</span> --cloud-provider<span class="o">=</span>auto-detect is deprecated. The desired cloud provider should be <span class="nb">set</span> explicitly
                                                                                                                                                                                                                                                                                                                                                                                       W1117 <span class="m">17</span>:52:52.983465   <span class="m">28490</span> server.go:324<span class="o">]</span> standalone mode, no API client
                                                                                                                                                                                                                                                                                                                                                                                                                                    I1117 <span class="m">17</span>:52:52.983810   <span class="m">28490</span> manager.go:149<span class="o">]</span> cAdvisor running in container: <span class="s2">&#34;/sys/fs/cgroup/cpu,cpuacct/user.slice&#34;</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  W1117 <span class="m">17</span>:52:53.017865   <span class="m">28490</span> manager.go:157<span class="o">]</span> unable to connect to Rkt api service: rkt: cannot tcp Dial rkt api service: dial tcp <span class="o">[</span>::1<span class="o">]</span>:15441: getsockopt: connection refused
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                W1117 <span class="m">17</span>:52:53.018035   <span class="m">28490</span> manager.go:166<span class="o">]</span> unable to connect to CRI-O api service: Get http://%2Fvar%2Frun%2Fcrio.sock/info: dial unix /var/run/crio.sock: connect: no such file or directory
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              I1117 <span class="m">17</span>:52:53.049774   <span class="m">28490</span> fs.go:139<span class="o">]</span> Filesystem UUIDs: map<span class="o">[</span>90ef4dc9-3b9e-4031-ad7f-209b328d2f3b:/dev/sda1 <span class="m">2017</span>-02-15-20-36-22-00:/dev/sr0 3687da9b-d812-42a1-b42c-a3d3e7178372:/dev/dm-0 8679fa71-e60b-4686-a5fa-9a0cc5023568:/dev/dm-1<span class="o">]</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       I1117 <span class="m">17</span>:52:53.049836   <span class="m">28490</span> fs.go:140<span class="o">]</span> Filesystem partitions: map<span class="o">[</span>tmpfs:<span class="o">{</span>mountpoint:/run major:0 minor:19 fsType:tmpfs blockSize:0<span class="o">}</span> /dev/mapper/ubuntu--vg-root:<span class="o">{</span>mountpoint:/var/lib/docker/aufs major:252 minor:0 fsType:ext4 blockSize:0<span class="o">}</span> /dev/sda1:<span class="o">{</span>mountpoint:/boot major:8 minor:1 fsType:ext2 blockSize:0<span class="o">}]</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                I1117 <span class="m">17</span>:52:53.052104   <span class="m">28490</span> manager.go:216<span class="o">]</span> Machine: <span class="o">{</span>NumCores:4 CpuFrequency:2097571 MemoryCapacity:8371290112 HugePages:<span class="o">[{</span>PageSize:1048576 NumPages:0<span class="o">}</span> <span class="o">{</span>PageSize:2048 NumPages:0<span class="o">}]</span> MachineID:78cb13728eba6f6c819e6dea599a5db9 SystemUUID:564D7A67-BDF7-E109-61AC-DDC9929A346F BootID:8f8d7bb3-abb6-4d6a-b1ee-261cd1a2cc74 Filesystems:<span class="o">[{</span>Device:tmpfs DeviceMajor:0 DeviceMinor:19 Capacity:837132288 Type:vfs Inodes:1021886 HasInodes:true<span class="o">}</span> <span class="o">{</span>Device:/dev/mapper/ubuntu--vg-root DeviceMajor:252 DeviceMinor:0 Capacity:75452612608 Type:vfs Inodes:4694016 HasInodes:true<span class="o">}</span> <span class="o">{</span>Device:/dev/sda1 DeviceMajor:8 DeviceMinor:1 Capacity:494512128 Type:vfs Inodes:124928 HasInodes:true<span class="o">}]</span> DiskMap:map<span class="o">[</span><span class="m">252</span>:0:<span class="o">{</span>Name:dm-0 Major:252 Minor:0 Size:76793511936 Scheduler:none<span class="o">}</span> <span class="m">252</span>:1:<span class="o">{</span>Name:dm-1 Major:252 Minor:1 Size:8589934592 Scheduler:none<span class="o">}</span> <span class="m">2</span>:0:<span class="o">{</span>Name:fd0 Major:2 Minor:0 Size:4096 Scheduler:deadline<span class="o">}</span> <span class="m">8</span>:0:<span class="o">{</span>Name:sda Major:8 Minor:0 Size:85899345920 Scheduler:deadline<span class="o">}]</span> NetworkDevices:<span class="o">[{</span>Name:cni0 MacAddress:0a:58:0a:f4:00:01 Speed:0 Mtu:1500<span class="o">}</span> <span class="o">{</span>Name:ens160 MacAddress:00:0c:29:9a:34:6f Speed:10000 Mtu:1500<span class="o">}</span> <span class="o">{</span>Name:flannel.1 MacAddress:b2:6d:04:a9:38:8d Speed:0 Mtu:1450<span class="o">}]</span> Topology:<span class="o">[{</span>Id:0 Memory:8371290112 Cores:<span class="o">[{</span>Id:0 Threads:<span class="o">[</span><span class="m">0</span><span class="o">]</span> Caches:<span class="o">[]}</span> <span class="o">{</span>Id:1 Threads:<span class="o">[</span><span class="m">1</span><span class="o">]</span> Caches:<span class="o">[]}</span> <span class="o">{</span>Id:2 Threads:<span class="o">[</span><span class="m">2</span><span class="o">]</span> Caches:<span class="o">[]}</span> <span class="o">{</span>Id:3 Threads:<span class="o">[</span><span class="m">3</span><span class="o">]</span> Caches:<span class="o">[]}]</span> Caches:<span class="o">[{</span>Size:20971520 Type:Unified Level:3<span class="o">}]}]</span> CloudProvider:Unknown InstanceType:Unknown InstanceID:None<span class="o">}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              I1117 <span class="m">17</span>:52:53.053151   <span class="m">28490</span> manager.go:222<span class="o">]</span> Version: <span class="o">{</span>KernelVersion:4.4.0-62-generic ContainerOsVersion:Ubuntu <span class="m">16</span>.04.3 LTS DockerVersion:17.05.0-ce DockerAPIVersion:1.29 CadvisorVersion: CadvisorRevision:<span class="o">}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            W1117 <span class="m">17</span>:52:53.053992   <span class="m">28490</span> server.go:232<span class="o">]</span> No api server defined - no events will be sent to API server.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         I1117 <span class="m">17</span>:52:53.054023   <span class="m">28490</span> server.go:422<span class="o">]</span> --cgroups-per-qos enabled, but --cgroup-root was not specified.  defaulting to /
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      I1117 <span class="m">17</span>:52:53.056245   <span class="m">28490</span> container_manager_linux.go:252<span class="o">]</span> container manager verified user specified cgroup-root exists: /
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    I1117 <span class="m">17</span>:52:53.056284   <span class="m">28490</span> container_manager_linux.go:257<span class="o">]</span> Creating Container Manager object based on Node Config: <span class="o">{</span>RuntimeCgroupsName: SystemCgroupsName: KubeletCgroupsName: ContainerRuntime:docker CgroupsPerQOS:true CgroupRoot:/ CgroupDriver:cgroupfs ProtectKernelDefaults:false NodeAllocatableConfig:<span class="o">{</span>KubeReservedCgroupName: SystemReservedCgroupName: EnforceNodeAllocatable:map<span class="o">[</span>pods:<span class="o">{}]</span> KubeReserved:map<span class="o">[]</span> SystemReserved:map<span class="o">[]</span> HardEvictionThresholds:<span class="o">[{</span>Signal:memory.available Operator:LessThan Value:<span class="o">{</span>Quantity:100Mi Percentage:0<span class="o">}</span> GracePeriod:0s MinReclaim:&lt;nil&gt;<span class="o">}</span> <span class="o">{</span>Signal:nodefs.available Operator:LessThan Value:<span class="o">{</span>Quantity:&lt;nil&gt; Percentage:0.1<span class="o">}</span> GracePeriod:0s MinReclaim:&lt;nil&gt;<span class="o">}</span> <span class="o">{</span>Signal:nodefs.inodesFree Operator:LessThan Value:<span class="o">{</span>Quantity:&lt;nil&gt; Percentage:0.05<span class="o">}</span> GracePeriod:0s MinReclaim:&lt;nil&gt;<span class="o">}]}</span> ExperimentalQOSReserved:map<span class="o">[]</span> ExperimentalCPUManagerPolicy:none ExperimentalCPUManagerReconcilePeriod:10s<span class="o">}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  I1117 <span class="m">17</span>:52:53.056462   <span class="m">28490</span> container_manager_linux.go:288<span class="o">]</span> Creating device plugin handler: <span class="nb">false</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                W1117 <span class="m">17</span>:52:53.061351   <span class="m">28490</span> kubelet_network.go:69<span class="o">]</span> Hairpin mode <span class="nb">set</span> to <span class="s2">&#34;promiscuous-bridge&#34;</span> but kubenet is not enabled, falling back to <span class="s2">&#34;hairpin-veth&#34;</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     I1117 <span class="m">17</span>:52:53.061391   <span class="m">28490</span> kubelet.go:517<span class="o">]</span> Hairpin mode <span class="nb">set</span> to <span class="s2">&#34;hairpin-veth&#34;</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   W1117 <span class="m">17</span>:52:53.065042   <span class="m">28490</span> cni.go:196<span class="o">]</span> Unable to update cni config: No networks found in /etc/cni/net.d
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             I1117 <span class="m">17</span>:52:53.071790   <span class="m">28490</span> docker_service.go:207<span class="o">]</span> Docker cri networking managed by kubernetes.io/no-op
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  I1117 <span class="m">17</span>:52:53.102961   <span class="m">28490</span> docker_service.go:224<span class="o">]</span> Setting cgroupDriver to cgroupfs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       I1117 <span class="m">17</span>:52:53.140011   <span class="m">28490</span> remote_runtime.go:43<span class="o">]</span> Connecting to runtime service unix:///var/run/dockershim.sock
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           I1117 <span class="m">17</span>:52:53.142110   <span class="m">28490</span> kuberuntime_manager.go:178<span class="o">]</span> Container runtime docker initialized, version: <span class="m">17</span>.05.0-ce, apiVersion: <span class="m">1</span>.29.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     W1117 <span class="m">17</span>:52:53.142331   <span class="m">28490</span> probe.go:215<span class="o">]</span> Flexvolume plugin directory at /usr/libexec/kubernetes/kubelet-plugins/volume/exec/ does not exist. Recreating.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 I1117 <span class="m">17</span>:52:53.144299   <span class="m">28490</span> server.go:718<span class="o">]</span> Started kubelet v1.8.3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              E1117 <span class="m">17</span>:52:53.144359   <span class="m">28490</span> kubelet.go:1234<span class="o">]</span> Image garbage collection failed once. Stats initialization may not have completed yet: failed to get imageFs info: unable to find data <span class="k">for</span> container /
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             W1117 <span class="m">17</span>:52:53.144478   <span class="m">28490</span> kubelet.go:1318<span class="o">]</span> No api server defined - no node status update will be sent.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            I1117 <span class="m">17</span>:52:53.144496   <span class="m">28490</span> server.go:128<span class="o">]</span> Starting to listen on <span class="m">0</span>.0.0.0:10250
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         I1117 <span class="m">17</span>:52:53.145570   <span class="m">28490</span> kubelet_node_status.go:280<span class="o">]</span> Setting node annotation to <span class="nb">enable</span> volume controller attach/detach
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   I1117 <span class="m">17</span>:52:53.146415   <span class="m">28490</span> server.go:296<span class="o">]</span> Adding debug handlers to kubelet server.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                I1117 <span class="m">17</span>:52:53.159723   <span class="m">28490</span> fs_resource_analyzer.go:66<span class="o">]</span> Starting FS ResourceAnalyzer
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          I1117 <span class="m">17</span>:52:53.159773   <span class="m">28490</span> status_manager.go:136<span class="o">]</span> Kubernetes client is nil, not starting status manager.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               I1117 <span class="m">17</span>:52:53.159791   <span class="m">28490</span> kubelet.go:1768<span class="o">]</span> Starting kubelet main sync loop.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              I1117 <span class="m">17</span>:52:53.159842   <span class="m">28490</span> kubelet.go:1779<span class="o">]</span> skipping pod synchronization - <span class="o">[</span>container runtime is down PLEG is not healthy: pleg was last seen active 2562047h47m16.854775807s ago<span class="p">;</span> threshold is 3m0s<span class="o">]</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             W1117 <span class="m">17</span>:52:53.160705   <span class="m">28490</span> container_manager_linux.go:869<span class="o">]</span> CPUAccounting not enabled <span class="k">for</span> pid: <span class="m">28490</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           W1117 <span class="m">17</span>:52:53.160728   <span class="m">28490</span> container_manager_linux.go:872<span class="o">]</span> MemoryAccounting not enabled <span class="k">for</span> pid: <span class="m">28490</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         E1117 <span class="m">17</span>:52:53.160816   <span class="m">28490</span> container_manager_linux.go:603<span class="o">]</span> <span class="o">[</span>ContainerManager<span class="o">]</span>: Fail to get rootfs information unable to find data <span class="k">for</span> container /
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       I1117 <span class="m">17</span>:52:53.160887   <span class="m">28490</span> volume_manager.go:246<span class="o">]</span> Starting Kubelet Volume Manager
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            I1117 <span class="m">17</span>:52:53.228692   <span class="m">28490</span> factory.go:355<span class="o">]</span> Registering Docker factory
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          W1117 <span class="m">17</span>:52:53.228739   <span class="m">28490</span> manager.go:265<span class="o">]</span> Registration of the rkt container factory failed: unable to communicate with Rkt api service: rkt: cannot tcp Dial rkt api service: dial tcp <span class="o">[</span>::1<span class="o">]</span>:15441: getsockopt: connection refused
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        W1117 <span class="m">17</span>:52:53.228910   <span class="m">28490</span> manager.go:276<span class="o">]</span> Registration of the crio container factory failed: Get http://%2Fvar%2Frun%2Fcrio.sock/info: dial unix /var/run/crio.sock: connect: no such file or directory
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      I1117 <span class="m">17</span>:52:53.228931   <span class="m">28490</span> factory.go:54<span class="o">]</span> Registering systemd factory
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   I1117 <span class="m">17</span>:52:53.229203   <span class="m">28490</span> factory.go:86<span class="o">]</span> Registering Raw factory
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                I1117 <span class="m">17</span>:52:53.229466   <span class="m">28490</span> manager.go:1140<span class="o">]</span> Started watching <span class="k">for</span> new ooms in manager
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               I1117 <span class="m">17</span>:52:53.230193   <span class="m">28490</span> manager.go:311<span class="o">]</span> Starting recovery of all containers
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             I1117 <span class="m">17</span>:52:53.342529   <span class="m">28490</span> manager.go:316<span class="o">]</span> Recovery completed
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           I1117 <span class="m">17</span>:52:53.487640   <span class="m">28490</span> kubelet_node_status.go:280<span class="o">]</span> Setting node annotation to <span class="nb">enable</span> volume controller attach/detach
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     E1117 <span class="m">17</span>:52:53.522074   <span class="m">28490</span> summary.go:92<span class="o">]</span> Failed to get system container stats <span class="k">for</span> <span class="s2">&#34;/user.slice/user-1000.slice/session-553.scope&#34;</span>: failed to get cgroup stats <span class="k">for</span> <span class="s2">&#34;/user.slice/user-1000.slice/session-553.scope&#34;</span>: failed to get container info <span class="k">for</span> <span class="s2">&#34;/user.slice/user-1000.slice/session-553.scope&#34;</span>: unknown container <span class="s2">&#34;/user.slice/user-1000.slice/session-553.scope&#34;</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  W1117 <span class="m">17</span>:52:53.522142   <span class="m">28490</span> helpers.go:847<span class="o">]</span> eviction manager: no observation found <span class="k">for</span> eviction signal allocatableNodeFs.available
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                I1117 <span class="m">17</span>:53:03.522396   <span class="m">28490</span> kubelet_node_status.go:280<span class="o">]</span> Setting node annotation to <span class="nb">enable</span> volume controller attach/detach
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          E1117 <span class="m">17</span>:53:03.554477   <span class="m">28490</span> summary.go:92<span class="o">]</span> Failed to get system container stats <span class="k">for</span> <span class="s2">&#34;/user.slice/user-1000.slice/session-553.scope&#34;</span>: failed to get cgroup stats <span class="k">for</span> <span class="s2">&#34;/user.slice/user-1000.slice/session-553.scope&#34;</span>: failed to get container info <span class="k">for</span> <span class="s2">&#34;/user.slice/user-1000.slice/session-553.scope&#34;</span>: unknown container <span class="s2">&#34;/user.slice/user-1000.slice/session-553.scope&#34;</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       W1117 <span class="m">17</span>:53:03.554543   <span class="m">28490</span> helpers.go:847<span class="o">]</span> eviction manager: no observation found <span class="k">for</span> eviction signal allocatableNodeFs.available</code></pre></td></tr></table>
</div>
</div>
<p>这下是真的成功了。</p>

<p>打断它。把 &ndash;fail-swap-on=false 参数，加到 启动文件下吧。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="nb">cd</span> /lib/systemd/system
root@km:/lib/systemd/system# vi kubelet.service
root@km:/lib/systemd/system# cat kubelet.service
root@km:/lib/systemd/system# systemctl daemon-reload
root@km:/lib/systemd/system# systemctl start kubelet
root@km:/lib/systemd/system# systemctl status kubelet
● kubelet.service - kubelet: The Kubernetes Node Agent
Loaded: loaded <span class="o">(</span>/lib/systemd/system/kubelet.service<span class="p">;</span> enabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
Active: active <span class="o">(</span>running<span class="o">)</span> since Fri <span class="m">2017</span>-11-17 <span class="m">17</span>:54:21 CST<span class="p">;</span> 15s ago
Docs: http://kubernetes.io/docs/
Main PID: <span class="m">28824</span> <span class="o">(</span>kubelet<span class="o">)</span>
Tasks: <span class="m">14</span>
Memory: <span class="m">22</span>.5M
CPU: <span class="m">1</span>.005s
CGroup: /system.slice/kubelet.service
└─28824 /usr/bin/kubelet --fail-swap-on<span class="o">=</span><span class="nb">false</span>

Nov <span class="m">17</span> <span class="m">17</span>:54:21 km kubelet<span class="o">[</span><span class="m">28824</span><span class="o">]</span>: I1117 <span class="m">17</span>:54:21.815998   <span class="m">28824</span> factory.go:54<span class="o">]</span> Registering systemd factory

                                                                                Nov <span class="m">17</span> <span class="m">17</span>:54:21 km kubelet<span class="o">[</span><span class="m">28824</span><span class="o">]</span>: I1117 <span class="m">17</span>:54:21.816270   <span class="m">28824</span> factory.go:86<span class="o">]</span> Registering Raw factory
                                                                                                                                                                Nov <span class="m">17</span> <span class="m">17</span>:54:21 km kubelet<span class="o">[</span><span class="m">28824</span><span class="o">]</span>: I1117 <span class="m">17</span>:54:21.816520   <span class="m">28824</span> manager.go:1140<span class="o">]</span> Started watching <span class="k">for</span> new ooms in manager
                                                                                                                                                                                                                                                  Nov <span class="m">17</span> <span class="m">17</span>:54:21 km kubelet<span class="o">[</span><span class="m">28824</span><span class="o">]</span>: I1117 <span class="m">17</span>:54:21.817206   <span class="m">28824</span> manager.go:311<span class="o">]</span> Starting recovery of all containers
                                                                                                                                                                                                                                                                                                                                   Nov <span class="m">17</span> <span class="m">17</span>:54:21 km kubelet<span class="o">[</span><span class="m">28824</span><span class="o">]</span>: I1117 <span class="m">17</span>:54:21.915504   <span class="m">28824</span> manager.go:316<span class="o">]</span> Recovery completed
                                                                                                                                                                                                                                                                                                                                                                                                                    Nov <span class="m">17</span> <span class="m">17</span>:54:22 km kubelet<span class="o">[</span><span class="m">28824</span><span class="o">]</span>: I1117 <span class="m">17</span>:54:22.050494   <span class="m">28824</span> kubelet_node_status.go:280<span class="o">]</span> Setting node annotation to <span class="nb">enable</span> volume controller attach/detach
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Nov <span class="m">17</span> <span class="m">17</span>:54:22 km kubelet<span class="o">[</span><span class="m">28824</span><span class="o">]</span>: W1117 <span class="m">17</span>:54:22.082192   <span class="m">28824</span> helpers.go:847<span class="o">]</span> eviction manager: no observation found <span class="k">for</span> eviction signal allocatableNodeFs.available
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Nov <span class="m">17</span> <span class="m">17</span>:54:31 km systemd<span class="o">[</span><span class="m">1</span><span class="o">]</span>: Started kubelet: The Kubernetes Node Agent.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Nov <span class="m">17</span> <span class="m">17</span>:54:32 km kubelet<span class="o">[</span><span class="m">28824</span><span class="o">]</span>: I1117 <span class="m">17</span>:54:32.082476   <span class="m">28824</span> kubelet_node_status.go:280<span class="o">]</span> Setting node annotation to <span class="nb">enable</span> volume controller attach/detach
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Nov <span class="m">17</span> <span class="m">17</span>:54:32 km kubelet<span class="o">[</span><span class="m">28824</span><span class="o">]</span>: W1117 <span class="m">17</span>:54:32.114163   <span class="m">28824</span> helpers.go:847<span class="o">]</span> eviction manager: no observation found <span class="k">for</span> eviction signal allocatableNodeFs.available
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                root@km:/lib/systemd/system#</code></pre></td></tr></table>
</div>
</div>
<p>如果说, 想保证重开机也生效,那就直接
<a href="https://askubuntu.com/questions/214805/how-do-i-disable-swap">https://askubuntu.com/questions/214805/how-do-i-disable-swap</a> 来吧.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo swapoff -a</code></pre></td></tr></table>
</div>
</div>
<p>成功了。</p>

<h3 id="kubelet-stop">kubelet stop</h3>

<p>因为 kubeadm v1.8.3 在 kubeadm init 的过程中会自动启动 kubelet
,所以这里要把 kubelet stop了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">root@km:/lib/systemd/system# systemctl stop kubelet</code></pre></td></tr></table>
</div>
</div>
<p>好了。kubelet 这一块是OK了。</p>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">龙哥</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">2018-11-23</span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://b.qqbb.app/tags/kubernetes/">kubernetes</a>
          <a href="https://b.qqbb.app/tags/install/">install</a>
          <a href="https://b.qqbb.app/tags/before/">before</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/docker-registry-push-pull/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">docker-registry-push-pull</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/spacemacs-rocks-season-1-day-0-notes/">
            <span class="next-text nav-default">Spacemacs Rocks Day 0, Intro</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  
  

  

  

  
  
    



        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  
  
    <a href="mailto:273412935@qq.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>


<a href="https://b.qqbb.app/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
  
</div>

<div class="copyright">
  
  
  
  
  
  
  

  <span class="copyright-year">
    &copy;
    
      2017 -
    2019
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        圆月弯刀
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ="></script>
<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?9dd8f468d36a07a7a8bde80b13fe8eaf";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>





  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>










</body>
</html>
